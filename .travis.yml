language: julia
julia:
  # Test against these exact versions
  - 0.6.1
  - 0.6.2
  - 0.6.3
dist: trusty
sudo: false
os:
  - linux
  - osx

install:
  # On Linux, do the build within docker, on OSX just run the build directly
  - if [ $(uname) == Linux ]; then
        docker build -t ubuntu_with_cmake .ci;
        DOCKER_PATH=$(docker run -t ubuntu_with_cmake /bin/sh -c 'echo -n "$PATH"');
        JULIA_DIR=$(dirname $(dirname $(which julia)));
        docker run -t -e PATH="${JULIA_DIR}/bin:${DOCKER_PATH}" -v ${JULIA_DIR}:${JULIA_DIR} -v $(pwd):$(pwd) -w $(pwd) ubuntu_with_cmake .ci/build.sh;
    elif [ $(uname) == Darwin ]; then
      .ci/build.sh;
    fi

script:
  - cd build && ctest -V

notifications:
  email: true
